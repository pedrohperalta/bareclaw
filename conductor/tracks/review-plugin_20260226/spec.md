# Specification: Use Code-Review Plugin in PR Review Flow

**Track ID:** review-plugin_20260226
**Type:** Refactor
**Created:** 2026-02-26
**Status:** Draft

## Summary

Replace BAREclaw's generic PR review system prompt with a direct invocation of the `code-review` plugin (`/code-review:review-pr`), and simplify the clone process by removing the PR branch checkout.

## Context

BAREclaw's `POST /github-pr-review` endpoint spawns a Claude Code session to review PRs. Currently it uses a generic system prompt that tells Claude to look for review skills or fall back to `gh pr diff` + `gh pr review`. The team has built a dedicated `code-review` plugin (in `gen-ai-agents`) that provides structured three-pass review with Conductor plan compliance, confidence scoring, and PT-BR output. Target projects will have this plugin installed.

## Success Criteria

- [ ] The system prompt tells Claude to run `/code-review:review-pr {number} --repo {owner/repo}`
- [ ] The PR branch checkout steps are removed (clone stays on default branch)
- [ ] Existing tests are updated to match the new prompt

## Dependencies

Depends on the `code-review` plugin being installed in target projects ([gen-ai-agents PR #9](https://github.com/stone-payments/gen-ai-agents/pull/9)).

## Out of Scope

- Changes to the code-review plugin itself
- Changes to the endpoint validation, allowlist, or cancel-and-restart logic

## Technical Notes

- The plugin fetches PR data via `gh` CLI â€” no local branch checkout needed
- Staying on the default branch is preferred so Conductor context (spec.md, plan.md, style guides) is available

---

_Generated by Conductor. Review and edit as needed._
